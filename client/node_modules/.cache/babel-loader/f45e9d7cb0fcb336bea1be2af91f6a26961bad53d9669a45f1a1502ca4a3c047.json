{"ast":null,"code":"import _slicedToArray from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useRef}from\"react\";import React,{useState}from'react';import auth from'./../auth/auth-helper';import CardHeader from'@material-ui/core/CardHeader';import TextField from'@material-ui/core/TextField';import Avatar from'@material-ui/core/Avatar';import Icon from'@material-ui/core/Icon';import{makeStyles}from'@material-ui/core/styles';import{comment,uncomment}from'./api-post.js';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Comments(props){var classes=useStyles();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var jwt=auth.isAuthenticated();var handleChange=function handleChange(event){setText(event.target.value);};var addComment=function addComment(event){if(event.keyCode==13&&event.target.value){event.preventDefault();comment({userId:jwt.user._id},{t:jwt.token},props.postId,{text:text}).then(function(data){if(data.error){console.log(data.error);}else{setText('');props.updateComments(data.comments);}});}};var deleteComment=function deleteComment(comment){return function(event){uncomment({userId:jwt.user._id},{t:jwt.token},props.postId,comment).then(function(data){if(data.error){console.log(data.error);}else{props.updateComments(data.comments);}});};};var commentBody=function commentBody(item){return/*#__PURE__*/_jsxs(\"p\",{className:classes.commentText,children:[/*#__PURE__*/_jsx(Link,{to:\"/user/\"+item.postedBy._id,children:item.postedBy.name}),/*#__PURE__*/_jsx(\"br\",{}),item.text,/*#__PURE__*/_jsxs(\"span\",{className:classes.commentDate,children:[new Date(item.created).toDateString(),\" |\",auth.isAuthenticated().user._id===item.postedBy._id&&/*#__PURE__*/_jsx(Icon,{onClick:deleteComment(item),className:classes.commentDelete,children:\"delete\"})]})]});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+auth.isAuthenticated().user._id}),title:/*#__PURE__*/_jsx(TextField,{onKeyDown:addComment,multiline:true,value:text,onChange:handleChange,placeholder:\"Write something ...\",className:classes.commentField,margin:\"normal\"}),className:classes.cardHeader}),props.comments.map(function(item,i){return/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+item.postedBy._id}),title:commentBody(item),className:classes.cardHeader},i);})]});}","map":{"version":3,"names":["useContext","useEffect","useRef","React","useState","auth","CardHeader","TextField","Avatar","Icon","makeStyles","comment","uncomment","Link","jsx","_jsx","jsxs","_jsxs","Comments","props","classes","useStyles","_useState","_useState2","_slicedToArray","text","setText","jwt","isAuthenticated","handleChange","event","target","value","addComment","keyCode","preventDefault","userId","user","_id","t","token","postId","then","data","error","console","log","updateComments","comments","deleteComment","commentBody","item","className","commentText","children","to","postedBy","name","commentDate","Date","created","toDateString","onClick","commentDelete","avatar","smallAvatar","src","title","onKeyDown","multiline","onChange","placeholder","commentField","margin","cardHeader","map","i"],"sources":["/home/adbuls/social-media-app-MERN-master/client/src/components/comment/comment.js"],"sourcesContent":["import { useContext, useEffect, useRef } from \"react\";\nimport React, {useState} from 'react'\nimport auth from './../auth/auth-helper'\nimport CardHeader from '@material-ui/core/CardHeader'\nimport TextField from '@material-ui/core/TextField'\nimport Avatar from '@material-ui/core/Avatar'\nimport Icon from '@material-ui/core/Icon'\nimport PropTypes from 'prop-types'\nimport {makeStyles} from '@material-ui/core/styles'\nimport {comment, uncomment} from './api-post.js'\nimport {Link} from 'react-router-dom'\n\n\nexport default function Comments (props) {\n  const classes = useStyles()\n  const [text, setText] = useState('')\n  const jwt = auth.isAuthenticated()\n  const handleChange = event => {\n    setText(event.target.value)\n  }\n  const addComment = (event) => {\n    if(event.keyCode == 13 && event.target.value){\n      event.preventDefault()\n      comment({\n        userId: jwt.user._id\n      }, {\n        t: jwt.token\n      }, props.postId, {text: text}).then((data) => {\n        if (data.error) {\n          console.log(data.error)\n        } else {\n          setText('')\n          props.updateComments(data.comments)\n        }\n      })\n    }\n  }\n\n  const deleteComment = comment => event => {\n    uncomment({\n      userId: jwt.user._id\n    }, {\n      t: jwt.token\n    }, props.postId, comment).then((data) => {\n      if (data.error) {\n        console.log(data.error)\n      } else {\n        props.updateComments(data.comments)\n      }\n    })\n  }\n\n    const commentBody = item => {\n      return (\n        <p className={classes.commentText}>\n          <Link to={\"/user/\" + item.postedBy._id}>{item.postedBy.name}</Link><br/>\n          {item.text}\n          <span className={classes.commentDate}>\n            {(new Date(item.created)).toDateString()} |\n            {auth.isAuthenticated().user._id === item.postedBy._id &&\n              <Icon onClick={deleteComment(item)} className={classes.commentDelete}>delete</Icon> }\n          </span>\n        </p>\n      )\n    }\n\n    return (<div>\n        <CardHeader\n              avatar={\n                <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+auth.isAuthenticated().user._id}/>\n              }\n              title={ <TextField\n                onKeyDown={addComment}\n                multiline\n                value={text}\n                onChange={handleChange}\n                placeholder=\"Write something ...\"\n                className={classes.commentField}\n                margin=\"normal\"\n                />}\n              className={classes.cardHeader}\n        />\n        { props.comments.map((item, i) => {\n            return <CardHeader\n                      avatar={\n                        <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+item.postedBy._id}/>\n                      }\n                      title={commentBody(item)}\n                      className={classes.cardHeader}\n                      key={i}/>\n              })\n        }\n    </div>)\n}\n\nComments.propTypes = {\n  postId: PropTypes.string.isRequired,\n  comments: PropTypes.array.isRequired,\n  updateComments: PropTypes.func.isRequired\n}"],"mappings":"sIAAA,OAASA,UAAU,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CACrD,MAAO,CAAAC,KAAK,EAAGC,QAAQ,KAAO,OAAO,CACrC,MAAO,CAAAC,IAAI,KAAM,uBAAuB,CACxC,MAAO,CAAAC,UAAU,KAAM,8BAA8B,CACrD,MAAO,CAAAC,SAAS,KAAM,6BAA6B,CACnD,MAAO,CAAAC,MAAM,KAAM,0BAA0B,CAC7C,MAAO,CAAAC,IAAI,KAAM,wBAAwB,CAEzC,OAAQC,UAAU,KAAO,0BAA0B,CACnD,OAAQC,OAAO,CAAEC,SAAS,KAAO,eAAe,CAChD,OAAQC,IAAI,KAAO,kBAAkB,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAGrC,cAAe,SAAS,CAAAC,QAAQA,CAAEC,KAAK,CAAE,CACvC,GAAM,CAAAC,OAAO,CAAGC,SAAS,CAAC,CAAC,CAC3B,IAAAC,SAAA,CAAwBlB,QAAQ,CAAC,EAAE,CAAC,CAAAmB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA7BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,GAAM,CAAAI,GAAG,CAAGtB,IAAI,CAACuB,eAAe,CAAC,CAAC,CAClC,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAGC,KAAK,CAAI,CAC5BJ,OAAO,CAACI,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAC7B,CAAC,CACD,GAAM,CAAAC,UAAU,CAAG,QAAb,CAAAA,UAAUA,CAAIH,KAAK,CAAK,CAC5B,GAAGA,KAAK,CAACI,OAAO,EAAI,EAAE,EAAIJ,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAC3CF,KAAK,CAACK,cAAc,CAAC,CAAC,CACtBxB,OAAO,CAAC,CACNyB,MAAM,CAAET,GAAG,CAACU,IAAI,CAACC,GACnB,CAAC,CAAE,CACDC,CAAC,CAAEZ,GAAG,CAACa,KACT,CAAC,CAAErB,KAAK,CAACsB,MAAM,CAAE,CAAChB,IAAI,CAAEA,IAAI,CAAC,CAAC,CAACiB,IAAI,CAAC,SAACC,IAAI,CAAK,CAC5C,GAAIA,IAAI,CAACC,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAACH,IAAI,CAACC,KAAK,CAAC,CACzB,CAAC,IAAM,CACLlB,OAAO,CAAC,EAAE,CAAC,CACXP,KAAK,CAAC4B,cAAc,CAACJ,IAAI,CAACK,QAAQ,CAAC,CACrC,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAED,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAGtC,OAAO,QAAI,UAAAmB,KAAK,CAAI,CACxClB,SAAS,CAAC,CACRwB,MAAM,CAAET,GAAG,CAACU,IAAI,CAACC,GACnB,CAAC,CAAE,CACDC,CAAC,CAAEZ,GAAG,CAACa,KACT,CAAC,CAAErB,KAAK,CAACsB,MAAM,CAAE9B,OAAO,CAAC,CAAC+B,IAAI,CAAC,SAACC,IAAI,CAAK,CACvC,GAAIA,IAAI,CAACC,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAACH,IAAI,CAACC,KAAK,CAAC,CACzB,CAAC,IAAM,CACLzB,KAAK,CAAC4B,cAAc,CAACJ,IAAI,CAACK,QAAQ,CAAC,CACrC,CACF,CAAC,CAAC,CACJ,CAAC,GAEC,GAAM,CAAAE,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAGC,IAAI,CAAI,CAC1B,mBACElC,KAAA,MAAGmC,SAAS,CAAEhC,OAAO,CAACiC,WAAY,CAAAC,QAAA,eAChCvC,IAAA,CAACF,IAAI,EAAC0C,EAAE,CAAE,QAAQ,CAAGJ,IAAI,CAACK,QAAQ,CAAClB,GAAI,CAAAgB,QAAA,CAAEH,IAAI,CAACK,QAAQ,CAACC,IAAI,CAAO,CAAC,cAAA1C,IAAA,QAAI,CAAC,CACvEoC,IAAI,CAAC1B,IAAI,cACVR,KAAA,SAAMmC,SAAS,CAAEhC,OAAO,CAACsC,WAAY,CAAAJ,QAAA,EACjC,GAAI,CAAAK,IAAI,CAACR,IAAI,CAACS,OAAO,CAAC,CAAEC,YAAY,CAAC,CAAC,CAAC,IACzC,CAACxD,IAAI,CAACuB,eAAe,CAAC,CAAC,CAACS,IAAI,CAACC,GAAG,GAAKa,IAAI,CAACK,QAAQ,CAAClB,GAAG,eACpDvB,IAAA,CAACN,IAAI,EAACqD,OAAO,CAAEb,aAAa,CAACE,IAAI,CAAE,CAACC,SAAS,CAAEhC,OAAO,CAAC2C,aAAc,CAAAT,QAAA,CAAC,QAAM,CAAM,CAAC,EACjF,CAAC,EACN,CAAC,CAER,CAAC,CAED,mBAAQrC,KAAA,QAAAqC,QAAA,eACJvC,IAAA,CAACT,UAAU,EACL0D,MAAM,cACJjD,IAAA,CAACP,MAAM,EAAC4C,SAAS,CAAEhC,OAAO,CAAC6C,WAAY,CAACC,GAAG,CAAE,mBAAmB,CAAC7D,IAAI,CAACuB,eAAe,CAAC,CAAC,CAACS,IAAI,CAACC,GAAI,CAAC,CACnG,CACD6B,KAAK,cAAGpD,IAAA,CAACR,SAAS,EAChB6D,SAAS,CAAEnC,UAAW,CACtBoC,SAAS,MACTrC,KAAK,CAAEP,IAAK,CACZ6C,QAAQ,CAAEzC,YAAa,CACvB0C,WAAW,CAAC,qBAAqB,CACjCnB,SAAS,CAAEhC,OAAO,CAACoD,YAAa,CAChCC,MAAM,CAAC,QAAQ,CACd,CAAE,CACLrB,SAAS,CAAEhC,OAAO,CAACsD,UAAW,CACnC,CAAC,CACAvD,KAAK,CAAC6B,QAAQ,CAAC2B,GAAG,CAAC,SAACxB,IAAI,CAAEyB,CAAC,CAAK,CAC9B,mBAAO7D,IAAA,CAACT,UAAU,EACR0D,MAAM,cACJjD,IAAA,CAACP,MAAM,EAAC4C,SAAS,CAAEhC,OAAO,CAAC6C,WAAY,CAACC,GAAG,CAAE,mBAAmB,CAACf,IAAI,CAACK,QAAQ,CAAClB,GAAI,CAAC,CACrF,CACD6B,KAAK,CAAEjB,WAAW,CAACC,IAAI,CAAE,CACzBC,SAAS,CAAEhC,OAAO,CAACsD,UAAW,EACzBE,CAAG,CAAC,CACjB,CAAC,CAAC,EAEP,CAAC,CACV"},"metadata":{},"sourceType":"module","externalDependencies":[]}