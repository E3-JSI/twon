{"ast":null,"code":"import _slicedToArray from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useRef}from\"react\";import React,{useState}from'react';import CardHeader from'@material-ui/core/CardHeader';import TextField from'@material-ui/core/TextField';import Avatar from'@material-ui/core/Avatar';import Icon from'@material-ui/core/Icon';import{makeStyles}from'@material-ui/core/styles';import{Link}from'react-router-dom';import{AuthContext}from\"../../context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Comments(_ref){var props=_ref.props,classes=_ref.classes;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useContext=useContext(AuthContext),currentUser=_useContext.user;var handleChange=function handleChange(event){setText(event.target.value);};var addComment=function addComment(event){if(event.keyCode==13&&event.target.value){event.preventDefault();comment({userId:jwt.user._id},{t:jwt.token},props.postId,{text:text}).then(function(data){if(data.error){console.log(data.error);}else{setText('');props.updateComments(data.comments);}});}};var deleteComment=function deleteComment(comment){return function(event){uncomment({userId:jwt.user._id},{t:jwt.token},props.postId,comment).then(function(data){if(data.error){console.log(data.error);}else{props.updateComments(data.comments);}});};};var commentBody=function commentBody(item){return/*#__PURE__*/_jsxs(\"p\",{className:classes.commentText,children:[/*#__PURE__*/_jsx(Link,{to:\"/user/\"+item.postedBy._id,children:item.postedBy.name}),/*#__PURE__*/_jsx(\"br\",{}),item.text,/*#__PURE__*/_jsxs(\"span\",{className:classes.commentDate,children:[new Date(item.created).toDateString(),\" |\",auth.isAuthenticated().user._id===item.postedBy._id&&/*#__PURE__*/_jsx(Icon,{onClick:deleteComment(item),className:classes.commentDelete,children:\"delete\"})]})]});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+auth.isAuthenticated().user._id}),title:/*#__PURE__*/_jsx(TextField,{onKeyDown:addComment,multiline:true,value:text,onChange:handleChange,placeholder:\"Write something ...\",className:classes.commentField,margin:\"normal\"}),className:classes.cardHeader}),props.comments.map(function(item,i){return/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+item.postedBy._id}),title:commentBody(item),className:classes.cardHeader},i);})]});}","map":{"version":3,"names":["useContext","useEffect","useRef","React","useState","CardHeader","TextField","Avatar","Icon","makeStyles","Link","AuthContext","jsx","_jsx","jsxs","_jsxs","Comments","_ref","props","classes","_useState","_useState2","_slicedToArray","text","setText","_useContext","currentUser","user","handleChange","event","target","value","addComment","keyCode","preventDefault","comment","userId","jwt","_id","t","token","postId","then","data","error","console","log","updateComments","comments","deleteComment","uncomment","commentBody","item","className","commentText","children","to","postedBy","name","commentDate","Date","created","toDateString","auth","isAuthenticated","onClick","commentDelete","avatar","smallAvatar","src","title","onKeyDown","multiline","onChange","placeholder","commentField","margin","cardHeader","map","i"],"sources":["/home/adbuls/social-media-app-MERN-master/client/src/components/comment/comment.js"],"sourcesContent":["import { useContext, useEffect, useRef } from \"react\";\nimport React, {useState} from 'react'\nimport CardHeader from '@material-ui/core/CardHeader'\nimport TextField from '@material-ui/core/TextField'\nimport Avatar from '@material-ui/core/Avatar'\nimport Icon from '@material-ui/core/Icon'\nimport PropTypes from 'prop-types'\nimport {makeStyles} from '@material-ui/core/styles'\nimport {Link} from 'react-router-dom'\nimport { AuthContext } from \"../../context/AuthContext\";\n\n\nexport default function Comments ({props, classes}) {\n  const [text, setText] = useState('')\n\n  const { user: currentUser } = useContext(AuthContext);\n\n  const handleChange = event => {\n    setText(event.target.value)\n  }\n  const addComment = (event) => {\n    if(event.keyCode == 13 && event.target.value){\n      event.preventDefault()\n      comment({\n        userId: jwt.user._id\n      }, {\n        t: jwt.token\n      }, props.postId, {text: text}).then((data) => {\n        if (data.error) {\n          console.log(data.error)\n        } else {\n          setText('')\n          props.updateComments(data.comments)\n        }\n      })\n    }\n  }\n\n  const deleteComment = comment => event => {\n    uncomment({\n      userId: jwt.user._id\n    }, {\n      t: jwt.token\n    }, props.postId, comment).then((data) => {\n      if (data.error) {\n        console.log(data.error)\n      } else {\n        props.updateComments(data.comments)\n      }\n    })\n  }\n\n    const commentBody = item => {\n      return (\n        <p className={classes.commentText}>\n          <Link to={\"/user/\" + item.postedBy._id}>{item.postedBy.name}</Link><br/>\n          {item.text}\n          <span className={classes.commentDate}>\n            {(new Date(item.created)).toDateString()} |\n            {auth.isAuthenticated().user._id === item.postedBy._id &&\n              <Icon onClick={deleteComment(item)} className={classes.commentDelete}>delete</Icon> }\n          </span>\n        </p>\n      )\n    }\n\n    return (<div>\n        <CardHeader\n              avatar={\n                <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+auth.isAuthenticated().user._id}/>\n              }\n              title={ <TextField\n                onKeyDown={addComment}\n                multiline\n                value={text}\n                onChange={handleChange}\n                placeholder=\"Write something ...\"\n                className={classes.commentField}\n                margin=\"normal\"\n                />}\n              className={classes.cardHeader}\n        />\n        { props.comments.map((item, i) => {\n            return <CardHeader\n                      avatar={\n                        <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+item.postedBy._id}/>\n                      }\n                      title={commentBody(item)}\n                      className={classes.cardHeader}\n                      key={i}/>\n              })\n        }\n    </div>)\n}\n\nComments.propTypes = {\n  postId: PropTypes.string.isRequired,\n  comments: PropTypes.array.isRequired,\n  updateComments: PropTypes.func.isRequired\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}