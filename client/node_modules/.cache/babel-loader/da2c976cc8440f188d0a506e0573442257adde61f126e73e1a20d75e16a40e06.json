{"ast":null,"code":"import _regeneratorRuntime from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useRef}from\"react\";import React,{useState}from'react';import CardHeader from'@material-ui/core/CardHeader';import TextField from'@material-ui/core/TextField';import Avatar from'@material-ui/core/Avatar';import Icon from'@material-ui/core/Icon';import axios from\"axios\";import{makeStyles}from'@material-ui/core/styles';import{Link}from'react-router-dom';import{AuthContext}from\"../../context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Comments(_ref){var props=_ref.props,classes=_ref.classes;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var desc=useRef();var _useContext=useContext(AuthContext),currentUser=_useContext.user;var handleChange=function handleChange(event){setText(event.target.value);};// submit a comment\nvar submitHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newComment;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();newComment={userId:currentUser._id,desc:desc.current.value};_context.prev=2;_context.next=5;return axios.put(\"/posts\"+props.postId+\"/comment\",{userId:currentUser._id});case 5:// refresh the page after posting something\nwindow.location.reload();_context.next=10;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);case 10:case\"end\":return _context.stop();}},_callee,null,[[2,8]]);}));return function submitHandler(_x){return _ref2.apply(this,arguments);};}();var deleteComment=function deleteComment(comment){return function(event){uncomment({userId:jwt.user._id},{t:jwt.token},props.postId,comment).then(function(data){if(data.error){console.log(data.error);}else{props.updateComments(data.comments);}});};};var commentBody=function commentBody(item){return/*#__PURE__*/_jsxs(\"p\",{className:classes.commentText,children:[/*#__PURE__*/_jsx(Link,{to:\"/user/\"+item.postedBy._id,children:item.postedBy.name}),/*#__PURE__*/_jsx(\"br\",{}),item.text,/*#__PURE__*/_jsxs(\"span\",{className:classes.commentDate,children:[new Date(item.created).toDateString(),\" |\",auth.isAuthenticated().user._id===item.postedBy._id&&/*#__PURE__*/_jsx(Icon,{onClick:deleteComment(item),className:classes.commentDelete,children:\"delete\"})]})]});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+auth.isAuthenticated().user._id}),title:/*#__PURE__*/_jsx(TextField,{onKeyDown:submitHandler,multiline:true,value:text,onChange:handleChange,placeholder:\"Write something ...\",className:classes.commentField,margin:\"normal\"}),className:classes.cardHeader}),props.comments.map(function(item,i){return/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+item.postedBy._id}),title:commentBody(item),className:classes.cardHeader},i);})]});}","map":{"version":3,"names":["useContext","useEffect","useRef","React","useState","CardHeader","TextField","Avatar","Icon","axios","makeStyles","Link","AuthContext","jsx","_jsx","jsxs","_jsxs","Comments","_ref","props","classes","_useState","_useState2","_slicedToArray","text","setText","desc","_useContext","currentUser","user","handleChange","event","target","value","submitHandler","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","newComment","wrap","_callee$","_context","prev","next","preventDefault","userId","_id","current","put","postId","window","location","reload","t0","stop","_x","apply","arguments","deleteComment","comment","uncomment","jwt","t","token","then","data","error","console","log","updateComments","comments","commentBody","item","className","commentText","children","to","postedBy","name","commentDate","Date","created","toDateString","auth","isAuthenticated","onClick","commentDelete","avatar","smallAvatar","src","title","onKeyDown","multiline","onChange","placeholder","commentField","margin","cardHeader","map","i"],"sources":["/home/adbuls/social-media-app-MERN-master/client/src/components/comment/comment.js"],"sourcesContent":["import {useContext, useEffect, useRef } from \"react\";\nimport React, {useState} from 'react'\nimport CardHeader from '@material-ui/core/CardHeader'\nimport TextField from '@material-ui/core/TextField'\nimport Avatar from '@material-ui/core/Avatar'\nimport Icon from '@material-ui/core/Icon'\nimport PropTypes from 'prop-types'\nimport axios from \"axios\"\nimport {makeStyles} from '@material-ui/core/styles'\nimport {Link} from 'react-router-dom'\nimport { AuthContext } from \"../../context/AuthContext\";\n\n\nexport default function Comments ({props, classes}) {\n  const [text, setText] = useState('')\n  const desc = useRef();\n  const { user: currentUser } = useContext(AuthContext);\n\n  const handleChange = event => {\n    setText(event.target.value)\n  }\n  \n  // submit a comment\n  const submitHandler = async (e) => {\n    e.preventDefault();\n    const newComment = {\n      userId: currentUser._id,\n      desc: desc.current.value,\n    };\n    try {\n      await axios.put(\"/posts\"+ props.postId + \"/comment\", { userId: currentUser._id });\n      // refresh the page after posting something\n      window.location.reload();\n    } catch (err) {}\n};\n\n\n  const deleteComment = comment => event => {\n    uncomment({\n      userId: jwt.user._id\n    }, {\n      t: jwt.token\n    }, props.postId, comment).then((data) => {\n      if (data.error) {\n        console.log(data.error)\n      } else {\n        props.updateComments(data.comments)\n      }\n    })\n  }\n\n    const commentBody = item => {\n      return (\n        <p className={classes.commentText}>\n          <Link to={\"/user/\" + item.postedBy._id}>{item.postedBy.name}</Link><br/>\n          {item.text}\n          <span className={classes.commentDate}>\n            {(new Date(item.created)).toDateString()} |\n            {auth.isAuthenticated().user._id === item.postedBy._id &&\n              <Icon onClick={deleteComment(item)} className={classes.commentDelete}>delete</Icon> }\n          </span>\n        </p>\n      )\n    }\n\n    return (<div>\n        <CardHeader\n              avatar={\n                <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+auth.isAuthenticated().user._id}/>\n              }\n              title={ <TextField\n                onKeyDown={submitHandler}\n                multiline\n                value={text}\n                onChange={handleChange}\n                placeholder=\"Write something ...\"\n                className={classes.commentField}\n                margin=\"normal\"\n                />}\n              className={classes.cardHeader}\n        />\n        { props.comments.map((item, i) => {\n            return <CardHeader\n                      avatar={\n                        <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+item.postedBy._id}/>\n                      }\n                      title={commentBody(item)}\n                      className={classes.cardHeader}\n                      key={i}/>\n              })\n        }\n    </div>)\n}\n\nComments.propTypes = {\n  postId: PropTypes.string.isRequired,\n  comments: PropTypes.array.isRequired,\n  updateComments: PropTypes.func.isRequired\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}