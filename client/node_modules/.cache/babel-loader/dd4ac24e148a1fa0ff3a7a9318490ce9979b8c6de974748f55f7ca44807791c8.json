{"ast":null,"code":"import _regeneratorRuntime from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import axios from\"axios\";import MoreHorizIcon from'@material-ui/icons/MoreHoriz';import{withStyles}from'@material-ui/core/styles';import{styles}from'./contactStyle';import{format}from'timeago.js';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Contact(_ref){var classes=_ref.classes,conversation=_ref.conversation,currentUser=_ref.currentUser,currentChat=_ref.currentChat;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var PF=process.env.REACT_APP_PUBLIC_FOLDER;var _useState3=useState({text:'No messages sent...',createdAt:'2021-06-27T20:40:21.739Z'}),_useState4=_slicedToArray(_useState3,2),lastMessage=_useState4[0],setLastMessage=_useState4[1];useEffect(function(){var friendId=conversation.members.find(function(m){return m!==currentUser._id;});var getUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var res;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return axios(\"/users?userId=\"+friendId);case 3:res=_context.sent;setUser(res.data);_context.next=10;break;case 7:_context.prev=7;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 10:case\"end\":return _context.stop();}},_callee,null,[[0,7]]);}));return function getUser(){return _ref2.apply(this,arguments);};}();getUser();getUser().then(function(){setTimeout(function(){if(conversation.lastMessage.length){setLastMessage({text:conversation.lastMessage[0].text,createdAt:conversation.lastMessage[0].createdAt});}},1000);});},[currentUser,conversation]);return/*#__PURE__*/_jsxs(\"div\",{className:(currentChat===null||currentChat===void 0?void 0:currentChat._id)===(conversation===null||conversation===void 0?void 0:conversation._id)?classes.activeContact:classes.contact,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.left,children:[/*#__PURE__*/_jsx(\"img\",{src:user!==null&&user!==void 0&&user.profilePicture?PF+user.profilePicture:PF+\"person/noAvatar.png\"}),/*#__PURE__*/_jsxs(\"div\",{className:classes.text,children:[/*#__PURE__*/_jsx(\"h1\",{children:user===null||user===void 0?void 0:user.username}),/*#__PURE__*/_jsx(\"p\",{children:lastMessage.text})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.right,children:[/*#__PURE__*/_jsx(MoreHorizIcon,{className:classes.moreIcon}),/*#__PURE__*/_jsx(\"p\",{children:format(lastMessage.createdAt)})]})]});}export default withStyles(styles)(Contact);","map":{"version":3,"names":["useEffect","useState","axios","MoreHorizIcon","withStyles","styles","format","jsx","_jsx","jsxs","_jsxs","Contact","_ref","classes","conversation","currentUser","currentChat","_useState","_useState2","_slicedToArray","user","setUser","PF","process","env","REACT_APP_PUBLIC_FOLDER","_useState3","text","createdAt","_useState4","lastMessage","setLastMessage","friendId","members","find","m","_id","getUser","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","res","wrap","_callee$","_context","prev","next","sent","data","t0","console","log","stop","apply","arguments","then","setTimeout","length","className","activeContact","contact","children","left","src","profilePicture","username","right","moreIcon"],"sources":["/home/adbuls/social-media-app-MERN-master/client/src/components/contact/Contact.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport MoreHorizIcon from '@material-ui/icons/MoreHoriz';\nimport { withStyles } from '@material-ui/core/styles';\nimport {styles} from './contactStyle';\nimport {format} from 'timeago.js'\n\nfunction Contact({classes, conversation, currentUser, currentChat }) {\n    const [user, setUser] = useState(null);\n    const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n    const [lastMessage, setLastMessage] = useState({\n      text: 'No messages sent...',\n      createdAt: '2021-06-27T20:40:21.739Z'\n    });\n\n    useEffect(() => {\n      const friendId = conversation.members.find((m) => m !== currentUser._id);\n  \n      const getUser = async () => {\n        try {\n          const res = await axios(\"/users?userId=\" + friendId);\n          setUser(res.data);       \n        } catch (err) {\n          console.log(err);\n        }\n      };\n      getUser();\n\n      getUser().then(() => {\n        setTimeout(() => {\n          if(conversation.lastMessage.length) {\n            setLastMessage({\n              text: conversation.lastMessage[0].text,\n              createdAt: conversation.lastMessage[0].createdAt\n            });\n          }\n        }, 1000)\n      })\n    }, [currentUser, conversation]);\n\n    return (\n        <div \n            className={currentChat?._id === conversation?._id ? classes.activeContact : classes.contact}\n            >\n            <div className={classes.left}>\n                <img src={\n                    user?.profilePicture\n                        ? PF + user.profilePicture\n                        : PF + \"person/noAvatar.png\"\n                }></img>\n                <div className={classes.text}>\n                    <h1>{user?.username}</h1>\n                    <p>{lastMessage.text}</p>\n                </div>\n            </div>\n            <div className={classes.right}>\n                <MoreHorizIcon className={classes.moreIcon}/>\n                <p>{format(lastMessage.createdAt)}</p>\n            </div>\n        </div>\n    )\n}\n\nexport default withStyles(styles)(Contact);\n"],"mappings":"kaAAA,OAASA,SAAS,CAAEC,QAAQ,KAAQ,OAAO,CAC3C,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,aAAa,KAAM,8BAA8B,CACxD,OAASC,UAAU,KAAQ,0BAA0B,CACrD,OAAQC,MAAM,KAAO,gBAAgB,CACrC,OAAQC,MAAM,KAAO,YAAY,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEjC,QAAS,CAAAC,OAAOA,CAAAC,IAAA,CAAqD,IAAnD,CAAAC,OAAO,CAAAD,IAAA,CAAPC,OAAO,CAAEC,YAAY,CAAAF,IAAA,CAAZE,YAAY,CAAEC,WAAW,CAAAH,IAAA,CAAXG,WAAW,CAAEC,WAAW,CAAAJ,IAAA,CAAXI,WAAW,CAC7D,IAAAC,SAAA,CAAwBhB,QAAQ,CAAC,IAAI,CAAC,CAAAiB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA/BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IACpB,GAAM,CAAAI,EAAE,CAAGC,OAAO,CAACC,GAAG,CAACC,uBAAuB,CAC9C,IAAAC,UAAA,CAAsCzB,QAAQ,CAAC,CAC7C0B,IAAI,CAAE,qBAAqB,CAC3BC,SAAS,CAAE,0BACb,CAAC,CAAC,CAAAC,UAAA,CAAAV,cAAA,CAAAO,UAAA,IAHKI,WAAW,CAAAD,UAAA,IAAEE,cAAc,CAAAF,UAAA,IAKlC7B,SAAS,CAAC,UAAM,CACd,GAAM,CAAAgC,QAAQ,CAAGlB,YAAY,CAACmB,OAAO,CAACC,IAAI,CAAC,SAACC,CAAC,QAAK,CAAAA,CAAC,GAAKpB,WAAW,CAACqB,GAAG,GAAC,CAExE,GAAM,CAAAC,OAAO,6BAAAC,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,MAAAC,GAAA,QAAAH,mBAAA,GAAAI,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEM,CAAA9C,KAAK,CAAC,gBAAgB,CAAG8B,QAAQ,CAAC,QAA9CW,GAAG,CAAAG,QAAA,CAAAG,IAAA,CACT5B,OAAO,CAACsB,GAAG,CAACO,IAAI,CAAC,CAACJ,QAAA,CAAAE,IAAA,iBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAK,EAAA,CAAAL,QAAA,aAElBM,OAAO,CAACC,GAAG,CAAAP,QAAA,CAAAK,EAAI,CAAC,CAAC,yBAAAL,QAAA,CAAAQ,IAAA,MAAAZ,OAAA,gBAEpB,kBAPK,CAAAL,OAAOA,CAAA,SAAAC,KAAA,CAAAiB,KAAA,MAAAC,SAAA,OAOZ,CACDnB,OAAO,CAAC,CAAC,CAETA,OAAO,CAAC,CAAC,CAACoB,IAAI,CAAC,UAAM,CACnBC,UAAU,CAAC,UAAM,CACf,GAAG5C,YAAY,CAACgB,WAAW,CAAC6B,MAAM,CAAE,CAClC5B,cAAc,CAAC,CACbJ,IAAI,CAAEb,YAAY,CAACgB,WAAW,CAAC,CAAC,CAAC,CAACH,IAAI,CACtCC,SAAS,CAAEd,YAAY,CAACgB,WAAW,CAAC,CAAC,CAAC,CAACF,SACzC,CAAC,CAAC,CACJ,CACF,CAAC,CAAE,IAAI,CAAC,CACV,CAAC,CAAC,CACJ,CAAC,CAAE,CAACb,WAAW,CAAED,YAAY,CAAC,CAAC,CAE/B,mBACIJ,KAAA,QACIkD,SAAS,CAAE,CAAA5C,WAAW,SAAXA,WAAW,iBAAXA,WAAW,CAAEoB,GAAG,KAAKtB,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEsB,GAAG,EAAGvB,OAAO,CAACgD,aAAa,CAAGhD,OAAO,CAACiD,OAAQ,CAAAC,QAAA,eAE5FrD,KAAA,QAAKkD,SAAS,CAAE/C,OAAO,CAACmD,IAAK,CAAAD,QAAA,eACzBvD,IAAA,QAAKyD,GAAG,CACJ7C,IAAI,SAAJA,IAAI,WAAJA,IAAI,CAAE8C,cAAc,CACd5C,EAAE,CAAGF,IAAI,CAAC8C,cAAc,CACxB5C,EAAE,CAAG,qBACd,CAAM,CAAC,cACRZ,KAAA,QAAKkD,SAAS,CAAE/C,OAAO,CAACc,IAAK,CAAAoC,QAAA,eACzBvD,IAAA,OAAAuD,QAAA,CAAK3C,IAAI,SAAJA,IAAI,iBAAJA,IAAI,CAAE+C,QAAQ,CAAK,CAAC,cACzB3D,IAAA,MAAAuD,QAAA,CAAIjC,WAAW,CAACH,IAAI,CAAI,CAAC,EACxB,CAAC,EACL,CAAC,cACNjB,KAAA,QAAKkD,SAAS,CAAE/C,OAAO,CAACuD,KAAM,CAAAL,QAAA,eAC1BvD,IAAA,CAACL,aAAa,EAACyD,SAAS,CAAE/C,OAAO,CAACwD,QAAS,CAAC,CAAC,cAC7C7D,IAAA,MAAAuD,QAAA,CAAIzD,MAAM,CAACwB,WAAW,CAACF,SAAS,CAAC,CAAI,CAAC,EACrC,CAAC,EACL,CAAC,CAEd,CAEA,cAAe,CAAAxB,UAAU,CAACC,MAAM,CAAC,CAACM,OAAO,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}