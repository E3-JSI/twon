{"ast":null,"code":"import _regeneratorRuntime from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/adbuls/social-media-app-MERN-master/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useEffect,useRef}from\"react\";import React,{useState}from'react';import CardHeader from'@material-ui/core/CardHeader';import TextField from'@material-ui/core/TextField';import Avatar from'@material-ui/core/Avatar';import Icon from'@material-ui/core/Icon';import{makeStyles}from'@material-ui/core/styles';import{Link}from'react-router-dom';import{AuthContext}from\"../../context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Comments(_ref){var props=_ref.props,classes=_ref.classes;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),text=_useState2[0],setText=_useState2[1];var _useContext=useContext(AuthContext),currentUser=_useContext.user;var handleChange=function handleChange(event){setText(event.target.value);};// submit a comment\nvar submitHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var newComment;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();newComment={userId:user._id,desc:desc.current.value};_context.prev=2;_context.next=5;return axios.post(\"/posts\"+post._id+\"/comment\",{userId:currentUser._id});case 5:// refresh the page after posting something\nwindow.location.reload();_context.next=10;break;case 8:_context.prev=8;_context.t0=_context[\"catch\"](2);case 10:case\"end\":return _context.stop();}},_callee,null,[[2,8]]);}));return function submitHandler(_x){return _ref2.apply(this,arguments);};}();var deleteComment=function deleteComment(comment){return function(event){uncomment({userId:jwt.user._id},{t:jwt.token},props.postId,comment).then(function(data){if(data.error){console.log(data.error);}else{props.updateComments(data.comments);}});};};var commentBody=function commentBody(item){return/*#__PURE__*/_jsxs(\"p\",{className:classes.commentText,children:[/*#__PURE__*/_jsx(Link,{to:\"/user/\"+item.postedBy._id,children:item.postedBy.name}),/*#__PURE__*/_jsx(\"br\",{}),item.text,/*#__PURE__*/_jsxs(\"span\",{className:classes.commentDate,children:[new Date(item.created).toDateString(),\" |\",auth.isAuthenticated().user._id===item.postedBy._id&&/*#__PURE__*/_jsx(Icon,{onClick:deleteComment(item),className:classes.commentDelete,children:\"delete\"})]})]});};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+auth.isAuthenticated().user._id}),title:/*#__PURE__*/_jsx(TextField,{onKeyDown:submitHandler,multiline:true,value:text,onChange:handleChange,placeholder:\"Write something ...\",className:classes.commentField,margin:\"normal\"}),className:classes.cardHeader}),props.comments.map(function(item,i){return/*#__PURE__*/_jsx(CardHeader,{avatar:/*#__PURE__*/_jsx(Avatar,{className:classes.smallAvatar,src:'/api/users/photo/'+item.postedBy._id}),title:commentBody(item),className:classes.cardHeader},i);})]});}","map":{"version":3,"names":["useContext","useEffect","useRef","React","useState","CardHeader","TextField","Avatar","Icon","makeStyles","Link","AuthContext","jsx","_jsx","jsxs","_jsxs","Comments","_ref","props","classes","_useState","_useState2","_slicedToArray","text","setText","_useContext","currentUser","user","handleChange","event","target","value","submitHandler","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","e","newComment","wrap","_callee$","_context","prev","next","preventDefault","userId","_id","desc","current","axios","post","window","location","reload","t0","stop","_x","apply","arguments","deleteComment","comment","uncomment","jwt","t","token","postId","then","data","error","console","log","updateComments","comments","commentBody","item","className","commentText","children","to","postedBy","name","commentDate","Date","created","toDateString","auth","isAuthenticated","onClick","commentDelete","avatar","smallAvatar","src","title","onKeyDown","multiline","onChange","placeholder","commentField","margin","cardHeader","map","i"],"sources":["/home/adbuls/social-media-app-MERN-master/client/src/components/comment/comment.js"],"sourcesContent":["import { useContext, useEffect, useRef } from \"react\";\nimport React, {useState} from 'react'\nimport CardHeader from '@material-ui/core/CardHeader'\nimport TextField from '@material-ui/core/TextField'\nimport Avatar from '@material-ui/core/Avatar'\nimport Icon from '@material-ui/core/Icon'\nimport PropTypes from 'prop-types'\nimport {makeStyles} from '@material-ui/core/styles'\nimport {Link} from 'react-router-dom'\nimport { AuthContext } from \"../../context/AuthContext\";\n\n\nexport default function Comments ({props, classes}) {\n  const [text, setText] = useState('')\n\n  const { user: currentUser } = useContext(AuthContext);\n\n  const handleChange = event => {\n    setText(event.target.value)\n  }\n  \n  \n  // submit a comment\n  const submitHandler = async (e) => {\n    e.preventDefault();\n    const newComment = {\n      userId: user._id,\n      desc: desc.current.value,\n    };\n    try {\n      await axios.post(\"/posts\"+ post._id + \"/comment\", { userId: currentUser._id });\n      // refresh the page after posting something\n      window.location.reload();\n    } catch (err) {}\n};\n\n\n  const deleteComment = comment => event => {\n    uncomment({\n      userId: jwt.user._id\n    }, {\n      t: jwt.token\n    }, props.postId, comment).then((data) => {\n      if (data.error) {\n        console.log(data.error)\n      } else {\n        props.updateComments(data.comments)\n      }\n    })\n  }\n\n    const commentBody = item => {\n      return (\n        <p className={classes.commentText}>\n          <Link to={\"/user/\" + item.postedBy._id}>{item.postedBy.name}</Link><br/>\n          {item.text}\n          <span className={classes.commentDate}>\n            {(new Date(item.created)).toDateString()} |\n            {auth.isAuthenticated().user._id === item.postedBy._id &&\n              <Icon onClick={deleteComment(item)} className={classes.commentDelete}>delete</Icon> }\n          </span>\n        </p>\n      )\n    }\n\n    return (<div>\n        <CardHeader\n              avatar={\n                <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+auth.isAuthenticated().user._id}/>\n              }\n              title={ <TextField\n                onKeyDown={submitHandler}\n                multiline\n                value={text}\n                onChange={handleChange}\n                placeholder=\"Write something ...\"\n                className={classes.commentField}\n                margin=\"normal\"\n                />}\n              className={classes.cardHeader}\n        />\n        { props.comments.map((item, i) => {\n            return <CardHeader\n                      avatar={\n                        <Avatar className={classes.smallAvatar} src={'/api/users/photo/'+item.postedBy._id}/>\n                      }\n                      title={commentBody(item)}\n                      className={classes.cardHeader}\n                      key={i}/>\n              })\n        }\n    </div>)\n}\n\nComments.propTypes = {\n  postId: PropTypes.string.isRequired,\n  comments: PropTypes.array.isRequired,\n  updateComments: PropTypes.func.isRequired\n}"],"mappings":"kaAAA,OAASA,UAAU,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CACrD,MAAO,CAAAC,KAAK,EAAGC,QAAQ,KAAO,OAAO,CACrC,MAAO,CAAAC,UAAU,KAAM,8BAA8B,CACrD,MAAO,CAAAC,SAAS,KAAM,6BAA6B,CACnD,MAAO,CAAAC,MAAM,KAAM,0BAA0B,CAC7C,MAAO,CAAAC,IAAI,KAAM,wBAAwB,CAEzC,OAAQC,UAAU,KAAO,0BAA0B,CACnD,OAAQC,IAAI,KAAO,kBAAkB,CACrC,OAASC,WAAW,KAAQ,2BAA2B,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAGxD,cAAe,SAAS,CAAAC,QAAQA,CAAAC,IAAA,CAAoB,IAAjB,CAAAC,KAAK,CAAAD,IAAA,CAALC,KAAK,CAAEC,OAAO,CAAAF,IAAA,CAAPE,OAAO,CAC/C,IAAAC,SAAA,CAAwBhB,QAAQ,CAAC,EAAE,CAAC,CAAAiB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAA7BG,IAAI,CAAAF,UAAA,IAAEG,OAAO,CAAAH,UAAA,IAEpB,IAAAI,WAAA,CAA8BzB,UAAU,CAACW,WAAW,CAAC,CAAvCe,WAAW,CAAAD,WAAA,CAAjBE,IAAI,CAEZ,GAAM,CAAAC,YAAY,CAAG,QAAf,CAAAA,YAAYA,CAAGC,KAAK,CAAI,CAC5BL,OAAO,CAACK,KAAK,CAACC,MAAM,CAACC,KAAK,CAAC,CAC7B,CAAC,CAGD;AACA,GAAM,CAAAC,aAAa,6BAAAC,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAOC,CAAC,MAAAC,UAAA,QAAAJ,mBAAA,GAAAK,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SAC5BN,CAAC,CAACO,cAAc,CAAC,CAAC,CACZN,UAAU,CAAG,CACjBO,MAAM,CAAEnB,IAAI,CAACoB,GAAG,CAChBC,IAAI,CAAEA,IAAI,CAACC,OAAO,CAAClB,KACrB,CAAC,CAAAW,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAE,IAAA,SAEO,CAAAM,KAAK,CAACC,IAAI,CAAC,QAAQ,CAAEA,IAAI,CAACJ,GAAG,CAAG,UAAU,CAAE,CAAED,MAAM,CAAEpB,WAAW,CAACqB,GAAI,CAAC,CAAC,QAC9E;AACAK,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAACZ,QAAA,CAAAE,IAAA,iBAAAF,QAAA,CAAAC,IAAA,GAAAD,QAAA,CAAAa,EAAA,CAAAb,QAAA,sCAAAA,QAAA,CAAAc,IAAA,MAAAnB,OAAA,gBAE9B,kBAXO,CAAAL,aAAaA,CAAAyB,EAAA,SAAAxB,KAAA,CAAAyB,KAAA,MAAAC,SAAA,OAWpB,CAGC,GAAM,CAAAC,aAAa,CAAG,QAAhB,CAAAA,aAAaA,CAAGC,OAAO,QAAI,UAAAhC,KAAK,CAAI,CACxCiC,SAAS,CAAC,CACRhB,MAAM,CAAEiB,GAAG,CAACpC,IAAI,CAACoB,GACnB,CAAC,CAAE,CACDiB,CAAC,CAAED,GAAG,CAACE,KACT,CAAC,CAAE/C,KAAK,CAACgD,MAAM,CAAEL,OAAO,CAAC,CAACM,IAAI,CAAC,SAACC,IAAI,CAAK,CACvC,GAAIA,IAAI,CAACC,KAAK,CAAE,CACdC,OAAO,CAACC,GAAG,CAACH,IAAI,CAACC,KAAK,CAAC,CACzB,CAAC,IAAM,CACLnD,KAAK,CAACsD,cAAc,CAACJ,IAAI,CAACK,QAAQ,CAAC,CACrC,CACF,CAAC,CAAC,CACJ,CAAC,GAEC,GAAM,CAAAC,WAAW,CAAG,QAAd,CAAAA,WAAWA,CAAGC,IAAI,CAAI,CAC1B,mBACE5D,KAAA,MAAG6D,SAAS,CAAEzD,OAAO,CAAC0D,WAAY,CAAAC,QAAA,eAChCjE,IAAA,CAACH,IAAI,EAACqE,EAAE,CAAE,QAAQ,CAAGJ,IAAI,CAACK,QAAQ,CAACjC,GAAI,CAAA+B,QAAA,CAAEH,IAAI,CAACK,QAAQ,CAACC,IAAI,CAAO,CAAC,cAAApE,IAAA,QAAI,CAAC,CACvE8D,IAAI,CAACpD,IAAI,cACVR,KAAA,SAAM6D,SAAS,CAAEzD,OAAO,CAAC+D,WAAY,CAAAJ,QAAA,EACjC,GAAI,CAAAK,IAAI,CAACR,IAAI,CAACS,OAAO,CAAC,CAAEC,YAAY,CAAC,CAAC,CAAC,IACzC,CAACC,IAAI,CAACC,eAAe,CAAC,CAAC,CAAC5D,IAAI,CAACoB,GAAG,GAAK4B,IAAI,CAACK,QAAQ,CAACjC,GAAG,eACpDlC,IAAA,CAACL,IAAI,EAACgF,OAAO,CAAE5B,aAAa,CAACe,IAAI,CAAE,CAACC,SAAS,CAAEzD,OAAO,CAACsE,aAAc,CAAAX,QAAA,CAAC,QAAM,CAAM,CAAC,EACjF,CAAC,EACN,CAAC,CAER,CAAC,CAED,mBAAQ/D,KAAA,QAAA+D,QAAA,eACJjE,IAAA,CAACR,UAAU,EACLqF,MAAM,cACJ7E,IAAA,CAACN,MAAM,EAACqE,SAAS,CAAEzD,OAAO,CAACwE,WAAY,CAACC,GAAG,CAAE,mBAAmB,CAACN,IAAI,CAACC,eAAe,CAAC,CAAC,CAAC5D,IAAI,CAACoB,GAAI,CAAC,CACnG,CACD8C,KAAK,cAAGhF,IAAA,CAACP,SAAS,EAChBwF,SAAS,CAAE9D,aAAc,CACzB+D,SAAS,MACThE,KAAK,CAAER,IAAK,CACZyE,QAAQ,CAAEpE,YAAa,CACvBqE,WAAW,CAAC,qBAAqB,CACjCrB,SAAS,CAAEzD,OAAO,CAAC+E,YAAa,CAChCC,MAAM,CAAC,QAAQ,CACd,CAAE,CACLvB,SAAS,CAAEzD,OAAO,CAACiF,UAAW,CACnC,CAAC,CACAlF,KAAK,CAACuD,QAAQ,CAAC4B,GAAG,CAAC,SAAC1B,IAAI,CAAE2B,CAAC,CAAK,CAC9B,mBAAOzF,IAAA,CAACR,UAAU,EACRqF,MAAM,cACJ7E,IAAA,CAACN,MAAM,EAACqE,SAAS,CAAEzD,OAAO,CAACwE,WAAY,CAACC,GAAG,CAAE,mBAAmB,CAACjB,IAAI,CAACK,QAAQ,CAACjC,GAAI,CAAC,CACrF,CACD8C,KAAK,CAAEnB,WAAW,CAACC,IAAI,CAAE,CACzBC,SAAS,CAAEzD,OAAO,CAACiF,UAAW,EACzBE,CAAG,CAAC,CACjB,CAAC,CAAC,EAEP,CAAC,CACV"},"metadata":{},"sourceType":"module","externalDependencies":[]}